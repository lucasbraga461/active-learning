📝 Logging started - Output will be saved to: /Users/lucasbraga/Documents/GitHub/active-learning/experimentation-fraud/data/matched_quantities_results/logs/experiment_log_fraud_matched_quantities_01_20250917_224819.txt
⏰ Timestamp: 2025-09-17 22:48:19
================================================================================
💳 Credit Card Fraud Detection - MATCHED QUANTITIES COMPARISON
================================================================================
Dataset: Kaggle European Credit Card Fraud Dataset
Target: Fraud detection (Class: 0=non-fraud, 1=fraud)
Features: Time, V1-V28 (anonymized), Amount
================================================================================
🎯 Methodology: Passive learning matches active learning's sample quantities exactly
🔬 Objective: Isolate sample selection QUALITY vs QUANTITY effects
================================================================================
Model Configuration:
  Model Type: logistic

Plot Configuration:
  Show Plots: False

Experiment Configuration:
  Initial samples: 300
  Initial strategy: stratified
  Batch size: 68
  Iterations: 11
  Strategies: ['uncertainty', 'uncertainty', 'uncertainty', 'uncertainty', 'diversity', 'diversity', 'uncertainty', 'diversity', 'uncertainty', 'uncertainty', 'qbc']

✅ Loading fraud dataset from: /Users/lucasbraga/Documents/GitHub/active-learning/active-learning/data/european-credit-card-dataset/creditcard.csv
Loading and splitting credit card fraud data...
Dataset shape: (284807, 31)
🧹 Cleaning and preprocessing credit card fraud dataset...
  📊 Original dataset shape: (284807, 31)
  🔍 Missing values in original data:
    No missing values found
  🎯 Target distribution: {0: 284315, 1: 492}
  ⚠️  Fraud percentage: 0.173%
  ✓ Added cyclical time features (hour of day)
  ✓ Added log-transformed amount feature
  ✓ Added amount bins for interpretability
  ✓ One-hot encoded categorical features
  🔍 Checking for NaN values after preprocessing...
    ✓ No NaN values found after preprocessing
  🔧 Applying feature standardization...
    🔒 Using sorted column order for reproducibility
    ✓ Standardized 31 numerical features
    ✓ Kept 6 categorical features unchanged (already 0/1)
  📊 Final dataset shape: (284807, 37)
  🎯 Final target distribution: {0: 284315, 1: 492}
  📋 Feature columns: ['V1', 'V2', 'V3', 'V4', 'V5', 'V6', 'V7', 'V8', 'V9', 'V10', 'V11', 'V12', 'V13', 'V14', 'V15', 'V16', 'V17', 'V18', 'V19', 'V20', 'V21', 'V22', 'V23', 'V24', 'V25', 'V26', 'V27', 'V28', 'Time_hour_sin', 'Time_hour_cos', 'Amount_log', 'Amount_very_small', 'Amount_small', 'Amount_medium', 'Amount_large', 'Amount_very_large', 'Amount_extreme']
Features after preprocessing: 37
Label distribution: {0: 284315, 1: 492}
Train set: 227845 samples
Test set: 56962 samples
Label distribution in train: {0: 227451, 1: 394}
Label distribution in test: {0: 56864, 1: 98}

🧪 PHASE 1: ACTIVE LEARNING WITH QUANTITY TRACKING

============================================================
ACTIVE LEARNING EXPERIMENT - FRAUD DETECTION (WITH TRACKING)
============================================================
  🎯 Creating stratified initial split with 300 samples...
    Available fraud samples: 315
    Available non-fraud samples: 181961
    ✓ Selected 10 fraud + 290 non-fraud samples
    ✓ Initial fraud percentage: 3.33%
Initial labeled pool: 300 samples
Initial fraud in labeled: 10 samples (3.33%)
Remaining unlabeled: 181976 samples

--- Iteration 1 ---
Validation - F1: 0.6936, Accuracy: 0.9988, Precision: 0.6383, Recall: 0.7595
Selected 68 samples using uncertainty sampling
Total labeled samples: 368
Fraud in labeled: 10 samples (2.72%)
Remaining unlabeled: 181908

--- Iteration 2 ---
Validation - F1: 0.7947, Accuracy: 0.9993, Precision: 0.8333, Recall: 0.7595
Selected 68 samples using uncertainty sampling
Total labeled samples: 436
Fraud in labeled: 10 samples (2.29%)
Remaining unlabeled: 181840

--- Iteration 3 ---
Validation - F1: 0.7947, Accuracy: 0.9993, Precision: 0.8333, Recall: 0.7595
Selected 68 samples using uncertainty sampling
Total labeled samples: 504
Fraud in labeled: 11 samples (2.18%)
Remaining unlabeled: 181772

--- Iteration 4 ---
Validation - F1: 0.2367, Accuracy: 0.9905, Precision: 0.1376, Recall: 0.8481
Selected 68 samples using uncertainty sampling
Total labeled samples: 572
Fraud in labeled: 11 samples (1.92%)
Remaining unlabeled: 181704

--- Iteration 5 ---
Validation - F1: 0.6220, Accuracy: 0.9983, Precision: 0.5000, Recall: 0.8228
Selected 68 samples using diversity sampling
Total labeled samples: 640
Fraud in labeled: 20 samples (3.12%)
Remaining unlabeled: 181636

--- Iteration 6 ---
Validation - F1: 0.7711, Accuracy: 0.9992, Precision: 0.7356, Recall: 0.8101
Selected 68 samples using diversity sampling
Total labeled samples: 708
Fraud in labeled: 26 samples (3.67%)
Remaining unlabeled: 181568

--- Iteration 7 ---
Validation - F1: 0.7901, Accuracy: 0.9993, Precision: 0.7711, Recall: 0.8101
Selected 68 samples using uncertainty sampling
Total labeled samples: 776
Fraud in labeled: 34 samples (4.38%)
Remaining unlabeled: 181500

--- Iteration 8 ---
Validation - F1: 0.3785, Accuracy: 0.9952, Precision: 0.2436, Recall: 0.8481
Selected 68 samples using diversity sampling
Total labeled samples: 844
Fraud in labeled: 41 samples (4.86%)
Remaining unlabeled: 181432

--- Iteration 9 ---
Validation - F1: 0.4012, Accuracy: 0.9956, Precision: 0.2627, Recall: 0.8481
Selected 68 samples using uncertainty sampling
Total labeled samples: 912
Fraud in labeled: 41 samples (4.50%)
Remaining unlabeled: 181364

--- Iteration 10 ---
Validation - F1: 0.5197, Accuracy: 0.9973, Precision: 0.3771, Recall: 0.8354
Selected 68 samples using uncertainty sampling
Total labeled samples: 980
Fraud in labeled: 42 samples (4.29%)
Remaining unlabeled: 181296

--- Iteration 11 ---
Validation - F1: 0.6377, Accuracy: 0.9984, Precision: 0.5156, Recall: 0.8354

--- Final Test Evaluation ---
Test Performance - F1: 0.6007, Accuracy: 0.9980, Precision: 0.4595, Recall: 0.8673

🧪 PHASE 2: PASSIVE LEARNING WITH MATCHED QUANTITIES

============================================================
PASSIVE LEARNING EXPERIMENT - MATCHED QUANTITIES
============================================================
  🎯 Creating stratified initial split with 300 samples...
    Available fraud samples: 315
    Available non-fraud samples: 181961
    ✓ Selected 10 fraud + 290 non-fraud samples
    ✓ Initial fraud percentage: 3.33%
Initial labeled pool: 300 samples
Initial fraud in labeled: 10 samples (3.33%)
Remaining unlabeled: 181976 samples
🎯 MATCHED QUANTITIES: Following active learning's sample progression

--- Iteration 1 ---
Validation - F1: 0.6936, Accuracy: 0.9988, Precision: 0.6383, Recall: 0.7595
  🎯 MATCHED QUANTITIES: Selecting 0 fraud + 68 non-fraud
    ✓ Selected 0 fraud + 68 non-fraud
    ✓ Total: 68 samples
Total labeled samples: 368
Fraud in labeled: 10 samples (2.72%)
Remaining unlabeled: 181908

--- Iteration 2 ---
Validation - F1: 0.7018, Accuracy: 0.9989, Precision: 0.6522, Recall: 0.7595
  🎯 MATCHED QUANTITIES: Selecting 0 fraud + 68 non-fraud
    ✓ Selected 0 fraud + 68 non-fraud
    ✓ Total: 68 samples
Total labeled samples: 436
Fraud in labeled: 10 samples (2.29%)
Remaining unlabeled: 181840

--- Iteration 3 ---
Validation - F1: 0.7229, Accuracy: 0.9990, Precision: 0.6897, Recall: 0.7595
  🎯 MATCHED QUANTITIES: Selecting 1 fraud + 67 non-fraud
    ✓ Selected 1 fraud + 67 non-fraud
    ✓ Total: 68 samples
Total labeled samples: 504
Fraud in labeled: 11 samples (2.18%)
Remaining unlabeled: 181772

--- Iteration 4 ---
Validation - F1: 0.7317, Accuracy: 0.9990, Precision: 0.7059, Recall: 0.7595
  🎯 MATCHED QUANTITIES: Selecting 0 fraud + 68 non-fraud
    ✓ Selected 0 fraud + 68 non-fraud
    ✓ Total: 68 samples
Total labeled samples: 572
Fraud in labeled: 11 samples (1.92%)
Remaining unlabeled: 181704

--- Iteration 5 ---
Validation - F1: 0.7317, Accuracy: 0.9990, Precision: 0.7059, Recall: 0.7595
  🎯 MATCHED QUANTITIES: Selecting 9 fraud + 59 non-fraud
    ✓ Selected 9 fraud + 59 non-fraud
    ✓ Total: 68 samples
Total labeled samples: 640
Fraud in labeled: 20 samples (3.12%)
Remaining unlabeled: 181636

--- Iteration 6 ---
Validation - F1: 0.2169, Accuracy: 0.9900, Precision: 0.1255, Recall: 0.7975
  🎯 MATCHED QUANTITIES: Selecting 6 fraud + 62 non-fraud
    ✓ Selected 6 fraud + 62 non-fraud
    ✓ Total: 68 samples
Total labeled samples: 708
Fraud in labeled: 26 samples (3.67%)
Remaining unlabeled: 181568

--- Iteration 7 ---
Validation - F1: 0.0978, Accuracy: 0.9733, Precision: 0.0519, Recall: 0.8354
  🎯 MATCHED QUANTITIES: Selecting 8 fraud + 60 non-fraud
    ✓ Selected 8 fraud + 60 non-fraud
    ✓ Total: 68 samples
Total labeled samples: 776
Fraud in labeled: 34 samples (4.38%)
Remaining unlabeled: 181500

--- Iteration 8 ---
Validation - F1: 0.1018, Accuracy: 0.9744, Precision: 0.0542, Recall: 0.8354
  🎯 MATCHED QUANTITIES: Selecting 7 fraud + 61 non-fraud
    ✓ Selected 7 fraud + 61 non-fraud
    ✓ Total: 68 samples
Total labeled samples: 844
Fraud in labeled: 41 samples (4.86%)
Remaining unlabeled: 181432

--- Iteration 9 ---
Validation - F1: 0.1048, Accuracy: 0.9752, Precision: 0.0559, Recall: 0.8354
  🎯 MATCHED QUANTITIES: Selecting 0 fraud + 68 non-fraud
    ✓ Selected 0 fraud + 68 non-fraud
    ✓ Total: 68 samples
Total labeled samples: 912
Fraud in labeled: 41 samples (4.50%)
Remaining unlabeled: 181364

--- Iteration 10 ---
Validation - F1: 0.1060, Accuracy: 0.9756, Precision: 0.0566, Recall: 0.8354
  🎯 MATCHED QUANTITIES: Selecting 1 fraud + 67 non-fraud
    ✓ Selected 1 fraud + 67 non-fraud
    ✓ Total: 68 samples
Total labeled samples: 980
Fraud in labeled: 42 samples (4.29%)
Remaining unlabeled: 181296

--- Iteration 11 ---
Validation - F1: 0.1082, Accuracy: 0.9761, Precision: 0.0578, Recall: 0.8354

--- Final Test Evaluation ---
Test Performance - F1: 0.1089, Accuracy: 0.9750, Precision: 0.0580, Recall: 0.8878

================================================================================
MATCHED QUANTITIES EXPERIMENTAL RESULTS
================================================================================
Sample Quantity Progression:
Iteration | Active Fraud | Passive Fraud | Active Total | Passive Total
----------------------------------------------------------------------
 Initial |        10 |         10 |         300 |          300
       1 |        10 |         10 |         368 |          368
       2 |        10 |         10 |         436 |          436
       3 |        11 |         11 |         504 |          504
       4 |        11 |         11 |         572 |          572
       5 |        20 |         20 |         640 |          640
       6 |        26 |         26 |         708 |          708
       7 |        34 |         34 |         776 |          776
       8 |        41 |         41 |         844 |          844
       9 |        41 |         41 |         912 |          912
      10 |        42 |         42 |         980 |          980

Final Results Comparison:
Active Learning  F1: 0.6007
Passive Learning F1: 0.1089
F1 Improvement: 0.4918
Improvement %: 451.68%

Sample Usage Verification:
Active Learning:  42 fraud + 938 non-fraud = 980 total
Passive Learning: 42 fraud + 938 non-fraud = 980 total
✅ VERIFICATION PASSED: Sample quantities match exactly
🎯 This comparison isolates sample selection QUALITY effects

📝 Matched quantities experiment completed!
📊 Results demonstrate fair apples-to-apples comparison methodology
💾 Results saved to: /Users/lucasbraga/Documents/GitHub/active-learning/experimentation-fraud/data/matched_quantities_results/
